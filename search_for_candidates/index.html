<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">

	<title>F-statistic candidate signal search - Polgraw group</title>

        <link href="../css/bootstrap-3.0.3.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <link href="../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="..">Polgraw group</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="..">Home</a>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Pipeline description <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../input_data/">Input data generation</a>
                        </li>
                    
                        <li class="active">
                            <a href="./">F-statistic candidate signal search</a>
                        </li>
                    
                        <li >
                            <a href="../coincidences/">Coincidences between candidates</a>
                        </li>
                    
                        <li >
                            <a href="../fap_coincidences/">False alarm probablity of conicidences</a>
                        </li>
                    
                        <li >
                            <a href="../followup/">Followup of interesting outliers</a>
                        </li>
                    
                        <li >
                            <a href="../pipeline_script/">Pipeline: a minimal example</a>
                        </li>
                    
                        <li >
                            <a href="../articles/">Documents and publications</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li >
                    <a rel="next" href="../input_data/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../coincidences/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#f-statistic-candidate-signal-search">F-statistic candidate signal search</a></li>
        
            <li><a href="#algorithm-flowchart">Algorithm flowchart</a></li>
        
            <li><a href="#prerequisites">Prerequisites</a></li>
        
            <li><a href="#compilation">Compilation</a></li>
        
            <li><a href="#example">Example</a></li>
        
            <li><a href="#output-files">Output files</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="f-statistic-candidate-signal-search">F-statistic candidate signal search</h1>
<p>Production serial code for a network of detectors is available at <a href="https://github.com/mbejger/polgraw-allsky/tree/master/search/network/src-cpu">here</a>. <code>OpenMP</code> version is at <a href="https://github.com/mbejger/polgraw-allsky/tree/master/search/network/src-openmp">this location</a>. To get the whole pipeline, run <code>git clone https://github.com/mbejger/polgraw-allsky.git</code>. </p>
<h3 id="algorithm-flowchart">Algorithm flowchart</h3>
<h2 id="_1"></h2>
<p><img alt="Code flowchart" src="../img/flowchart.png" /></p>
<h3 id="prerequisites">Prerequisites</h3>
<p>The code is written in standard <code>C</code>. <a href="http://www.gnu.org/software/gsl/">GNU Scientific Library (GSL)</a> and the <a href="http://www.fftw.org">FFTW library</a> (version 3.0 or later) are needed to run the code. <a href="http://www.gnu.org/software/libc/manual/html_node/Accessing-Directories.html#Accessing-Directories">GNU struct dirent</a> objects are used to read the directories. </p>
<p>Optionally, <a href="http://shibatch.sourceforge.net">SLEEF</a> or <a href="http://www.yeppp.info">YEPPP!</a>, libraries for high-performance computing that are optimized for speed are used to evaluate the trigonometric functions in the search code. These libraries are ported with the source code and are located in <code>src/lib</code>. The choice which of these libraries to use has to be made at compilation time by modifying the <code>Makefile</code>. </p>
<h3 id="compilation">Compilation</h3>
<p>Run  <code>make gwsearch-cpu</code> or <code>make</code> in <code>search/network/src-cpu</code>, resulting  binary is called <code>gwsearch-cpu</code> (this is the default <code>C</code> version not-optimized with <code>openMP</code>; for the <code>openMP</code> version see the <code>search/network/src-openmp</code> directory). Modify the <code>Makefile</code> to fit your system. By default the <code>YEPPP!</code> library is selected. </p>
<h4 id="_2"></h4>
<h4 id="full-list-of-switches">Full list of switches</h4>
<p>For the full list of options, type</p>
<div class="codehilite"><pre><span></span>$ ./gwsearch-cpu --help 
</pre></div>


<table>
<thead>
<tr>
<th>Switch</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-data</td>
<td align="left">Data directory (default is <code>.</code>)</td>
</tr>
<tr>
<td>-output</td>
<td align="left">Output directory (default is <code>./candidates</code>)</td>
</tr>
<tr>
<td>-ident</td>
<td align="left">Frame number</td>
</tr>
<tr>
<td>-band</td>
<td align="left">Band number</td>
</tr>
<tr>
<td>-label</td>
<td align="left">Custom label for the input and output files</td>
</tr>
<tr>
<td>-range</td>
<td align="left">Use file with grid range or pulsar position</td>
</tr>
<tr>
<td>-getrange</td>
<td align="left">Write grid ranges &amp; save fft wisdom &amp; exit (ignore -r)</td>
</tr>
<tr>
<td>-cwd</td>
<td align="left">Change to directory <code>&lt;dir&gt;</code></td>
</tr>
<tr>
<td>-threshold</td>
<td align="left">Threshold for the <script type="math/tex">\mathcal{F}</script>-statistic (default is <code>20</code>)</td>
</tr>
<tr>
<td>-hemisphere</td>
<td align="left">Hemisphere (default is 0 - does both)</td>
</tr>
<tr>
<td>-fpo</td>
<td align="left">Reference band frequency <code>fpo</code> value</td>
</tr>
<tr>
<td>-dt</td>
<td align="left">Data sampling time dt (default value: <code>0.5</code>)</td>
</tr>
<tr>
<td>-usedet</td>
<td align="left">Use only detectors from string (default is <code>use all available</code>)</td>
</tr>
<tr>
<td>-addsig</td>
<td align="left">Add signal with parameters from <code>&lt;file&gt;</code></td>
</tr>
<tr>
<td>-narrowdown</td>
<td align="left">Narrow-down the frequency band (range <code>[0, 0.5] +- around center</code>)</td>
</tr>
</tbody>
</table>
<p>Also: </p>
<table>
<thead>
<tr>
<th></th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr>
<td>--whitenoise</td>
<td align="left">White Gaussian noise assumed</td>
</tr>
<tr>
<td>--nospindown</td>
<td align="left">Spindowns neglected</td>
</tr>
<tr>
<td>--nocheckpoint</td>
<td align="left">State file will not be created (no checkpointing)</td>
</tr>
<tr>
<td>--help</td>
<td align="left">This help</td>
</tr>
</tbody>
</table>
<h3 id="example">Example</h3>
<p>Minimal call to <code>gwsearch-cpu</code> is as follows (code compiled with the <code>GNUSINCOS</code> option): </p>
<div class="codehilite"><pre><span></span>./gwsearch-cpu -data ../../../testdata/2d_0.25 -dt 2 -output . -ident 001 -band 1234 -nod 2  
</pre></div>


<p>where</p>
<ul>
<li><code>data_dir</code> is the base directory of input data files,</li>
<li>Sampling time <code>dt</code> is <script type="math/tex">2 s</script>, </li>
<li><code>output_dir</code>is a directory to write the output (e.g., in current directory, . ) </li>
<li><code>ident</code> is the number of time frame to be analyzed (<script type="math/tex">001</script>),</li>
<li><code>nod</code> number of days is <script type="math/tex">2</script>, </li>
<li><code>band</code> is the number of the frequency band (see the <a href="../../input_data">input data structure</a> for details). </li>
</ul>
<h4 id="_3"></h4>
<h4 id="network-of-detectors">Network of detectors</h4>
<p>Test data frames <script type="math/tex">nnn=001-008</script> with pure Gaussian noise 2-day time segments with sampling time equal to 2s (<code>xdatc_nnn_1234.bin</code>) for two LIGO detectors H1 and L1 are <a href="https://polgraw.camk.edu.pl/H1L1_2d_0.25.tar.gz">available here</a>. </p>
<p>A sample call is </p>
<div class="codehilite"><pre><span></span>% <span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span>lib/yeppp-1.0.0/binaries/linux/x86_64 ./gwsearch-cpu <span class="se">\</span>
  -data ../../../testdata/2d_0.25/ <span class="se">\</span>
  -ident <span class="m">001</span> <span class="se">\</span>
  -band <span class="m">1234</span> <span class="se">\</span>
  -dt <span class="m">2</span> <span class="se">\ </span>
  -nod <span class="m">2</span> <span class="se">\ </span>
  -addsig sig1 <span class="se">\ </span> 
  -output . <span class="se">\</span>
  -threshold 14.5 <span class="se">\</span>
  --nocheckpoint
</pre></div>


<p>where the <code>LD_LIBRARY_PATH</code> points to the location of the <code>YEPPP!</code> library. </p>
<p>The program will proceed assuming that </p>
<ul>
<li>the data directory for frame <code>001</code> is located at <code>../../../testdata/2d_0.25/001</code> and contain subdirectories with input data for H1, L1 and/or V1 detectors (all available detectors are used by default; to select specific detectors, use <code>-usedet</code> option), </li>
<li>the grid of parameters files is expected to be in <code>../../../testdata/2d_0.25/001</code>, </li>
<li><code>band</code> equals to <script type="math/tex">1234</script>,  </li>
<li>the sampling time <code>dt</code> equals <script type="math/tex">2 s</script>, </li>
<li>number of days <code>nod</code> in <script type="math/tex">2</script>, </li>
<li>the <code>-addsig</code> option is used to add a software injection to pure noise Gaussian data. The signal's parameters are randomly generated using the <code>sigen</code> code (for more details see the <a href="../../pipeline_script">minimal example</a>).  </li>
<li>the threshold for the <script type="math/tex">\mathcal{F}</script>-statistic is set to be <script type="math/tex">14.5</script>,</li>
<li><code>-output</code> is the current directory, </li>
<li><code>--nocheckpoint</code> disables the checkpointing (writing the last visited position on the grid to the <code>state</code> file), </li>
</ul>
<h3 id="output-files">Output files</h3>
<p>Binary output files, containing trigger candidate events above an arbitrary threshold (option <code>-threshold</code> for the <script type="math/tex">\mathcal{F}</script>-statistic, default 20), are written to the <code>output_dir</code> directory. There are two output files for every input data sequence: <code>triggers_nnn_bbbb_1.bin</code> and
<code>triggers_nnn_bbbb_2.bin</code>,  where  <code>1</code> and  <code>2</code> correspond to the northern and southern ecliptic hemisphere. Each trigger (candidate) event occupies <code>40</code> consecutive bytes (5 double numbers), with the following meaning:</p>
<table>
<thead>
<tr>
<th>Record no.</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>frequency [radians, between 0 and <script type="math/tex">\pi</script>] above <code>fpo</code></td>
</tr>
<tr>
<td>2</td>
<td>spindown [<script type="math/tex">Hz/s</script>]</td>
</tr>
<tr>
<td>3</td>
<td>declination [radians, between <script type="math/tex">\pi</script> and <script type="math/tex">-\pi</script>]</td>
</tr>
<tr>
<td>4</td>
<td>right ascension [radians, between 0 and <script type="math/tex">2\pi</script>]</td>
</tr>
<tr>
<td>5</td>
<td>signal-to-noise ratio</td>
</tr>
</tbody>
</table>
<p>For the example above, the first 10 triggers from <code>triggers_001_1234_2.bin</code> are </p>
<div class="codehilite"><pre><span></span>3.05617018e+00 -3.42376198e-08 -7.68007347e-02 2.59248668e+00 5.06667333e+00 
1.18243015e+00 -3.20762991e-08 -7.68007347e-02 2.59248668e+00 5.05528873e+00 
1.08103361e-01 -2.77536578e-08 -7.68007347e-02 2.59248668e+00 5.07085254e+00 
1.90022435e+00 -2.77536578e-08 -7.68007347e-02 2.59248668e+00 5.15191593e+00 
1.90000217e+00 -2.55923371e-08 -7.68007347e-02 2.59248668e+00 5.42638039e+00 
2.09224664e+00 -2.34310165e-08 -7.68007347e-02 2.59248668e+00 5.20879551e+00 
2.38731576e+00 -2.12696958e-08 -7.68007347e-02 2.59248668e+00 5.31983396e+00 
3.00543165e+00 -1.91083751e-08 -7.68007347e-02 2.59248668e+00 5.29454616e+00 
7.49333983e-01 -1.26244131e-08 -7.68007347e-02 2.59248668e+00 5.08724856e+00 
2.08710778e-01  3.43510887e-10 -7.68007347e-02 2.59248668e+00 5.17537018e+00 
</pre></div>


<h4 id="_4"></h4>
<h4 id="auxiliary-output-files">Auxiliary output files</h4>
<ul>
<li>
<p><code>wisdom-hostname.dat</code> - performance-testing file created by the <code>FFTW</code>. The <code>hostname</code> variable is determined by a call to <code>gethostname()</code>, </p>
</li>
<li>
<p><code>state_nnn_bbbb.dat</code> - checkpointing file containing the last grid point visited. The search can  be safely restarted, calculations will continue  from the last grid position saved to this file. After successful termination, checkpoint file is left empty.</p>
</li>
</ul></div>
        </div>

	<footer class="col-md-12">
		<hr>
		
		<p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
	</footer>


        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script src="../js/base.js"></script>
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    </body>
</html>